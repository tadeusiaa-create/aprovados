<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>APROVADOS | AI EXPERIENCE</title>
    
    <style>
        /* --- IMPORTAÇÃO DE FONTES FUTURISTAS --- */
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Jura:wght@300;500;700&display=swap');

        /* --- VARIÁVEIS DO SISTEMA (DESIGN TOKENS) --- */
        :root {
            --purple: #bc13fe;
            --green: #00ff9d;
            --blue: #00d0ff;
            --bg: #050505;
            
            /* Vidro Fosco Otimizado */
            --glass-bg: rgba(0, 0, 0, 0.6);
            --glass-border: rgba(0, 255, 157, 0.2);
            --blur-amount: 10px;

            /* Safe Area para iOS (iPhone X+) */
            --safe-top: env(safe-area-inset-top);
            --safe-bottom: env(safe-area-inset-bottom);
            --safe-left: env(safe-area-inset-left);
            --safe-right: env(safe-area-inset-right);
        }

        /* --- RESET E BASE --- */
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

        body, html {
            margin: 0; padding: 0; width: 100%; height: 100%;
            background-color: var(--bg);
            overflow: hidden; /* Impede scroll na página principal */
            font-family: 'Orbitron', sans-serif;
            user-select: none;
        }

        /* --- CAMADA DE EFEITOS (VIGNETTE & GRAIN) --- */
        .vignette {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: radial-gradient(circle, transparent 40%, rgba(0,0,0,0.95) 100%);
            pointer-events: none; z-index: 5;
        }

        .grain {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.65' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)' opacity='0.05'/%3E%3C/svg%3E");
            pointer-events: none; z-index: 6; opacity: 0.35;
        }

        /* CANVAS 3D */
        #canvas-container { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 1; }

        /* --- GRID PRINCIPAL DE INTERFACE (UI) --- */
        #ui-layer {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            z-index: 10; pointer-events: none; /* Deixa clicar no 3D onde não tem UI */
            
            display: grid;
            /* Layout PC: Coluna Esq (Menu), Centro (Conteúdo), Coluna Dir (Info) */
            grid-template-columns: 240px 1fr 280px;
            grid-template-rows: 100px 1fr 80px;
            
            padding: 20px;
            padding-top: max(20px, var(--safe-top));
            padding-bottom: max(20px, var(--safe-bottom));
            padding-left: max(20px, var(--safe-left));
            padding-right: max(20px, var(--safe-right));
            
            gap: 15px;
        }

        /* --- COMPONENTE 1: INFO DE SISTEMA (Canto Sup Esq) --- */
        .hud-header {
            grid-column: 1 / 2; grid-row: 1 / 2;
            display: flex; flex-direction: column; justify-content: center;
            border-left: 3px solid var(--green);
            padding-left: 15px;
            opacity: 0.9;
        }
        .hud-text-small {
            font-size: 0.7rem; letter-spacing: 2px; color: var(--green);
            text-shadow: 0 0 5px rgba(0, 255, 157, 0.5);
            margin-bottom: 4px;
        }

        /* --- COMPONENTE 2: SIDEBAR / DOCK DE COMANDOS --- */
        .hud-sidebar {
            grid-column: 1 / 2; grid-row: 2 / 3;
            display: flex; flex-direction: column; 
            justify-content: center; gap: 20px;
            pointer-events: auto; /* Habilita clique */
        }

        .tech-btn {
            background: rgba(0, 0, 0, 0.6);
            border: 1px solid var(--purple);
            border-left: 4px solid var(--purple);
            padding: 12px 15px;
            color: #fff;
            font-family: 'Jura'; font-size: 0.85rem; font-weight: 700;
            text-align: left;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
            position: relative; overflow: hidden;
            text-transform: uppercase; letter-spacing: 1px;
            backdrop-filter: blur(var(--blur-amount));
            box-shadow: 0 4px 15px rgba(0,0,0,0.5);
        }

        .tech-btn:hover {
            background: rgba(188, 19, 254, 0.25);
            padding-left: 25px;
            box-shadow: 0 0 20px rgba(188, 19, 254, 0.4);
            border-left-color: #fff;
        }
        
        .btn-desc {
            font-size: 0.6rem; color: #aaa; display: block; margin-top: 4px; opacity: 0.8; font-weight: 300;
        }

        /* --- COMPONENTE 3: ÁREA CENTRAL (HERO) --- */
        #main-center {
            grid-column: 2 / 3; grid-row: 1 / 4; /* Ocupa todo o centro vertical */
            display: flex; flex-direction: column;
            align-items: center; justify-content: center;
            text-align: center;
            z-index: 20;
            transition: opacity 0.8s ease, transform 0.8s ease;
        }

        /* Status (Estrelas) */
        .stats-row {
            display: flex; gap: 15px; margin-bottom: 3vh;
            pointer-events: auto;
        }
        .stat-module {
            background: var(--glass-bg);
            backdrop-filter: blur(8px);
            border: 1px solid var(--glass-border);
            padding: 8px 15px;
            border-radius: 4px;
            clip-path: polygon(10% 0, 100% 0, 100% 80%, 90% 100%, 0 100%, 0 20%);
            box-shadow: 0 0 15px rgba(0, 255, 157, 0.1);
        }
        .stars { color: var(--green); letter-spacing: 3px; font-size: 0.8rem; text-shadow: 0 0 8px var(--green); }
        .stat-label { font-family: 'Jura'; font-size: 0.6rem; color: #fff; display: block; margin-top: 3px; }

        /* Títulos */
        .title-3d {
            font-size: clamp(3rem, 6vw, 7rem); /* Responsivo fluido */
            font-weight: 900;
            color: #fff; text-transform: uppercase; letter-spacing: -2px; line-height: 0.9;
            text-shadow: 0 0 20px rgba(188, 19, 254, 0.6);
            margin: 0 0 15px 0;
            animation: breathe 4s infinite ease-in-out;
        }

        .subtitle-3d {
            font-family: 'Jura', sans-serif; 
            font-size: clamp(0.9rem, 1.5vw, 1.3rem);
            color: var(--green); letter-spacing: 6px; text-transform: uppercase;
            background: rgba(0,0,0,0.7); padding: 8px 24px;
            border-left: 2px solid var(--green); border-right: 2px solid var(--green);
            backdrop-filter: blur(5px);
        }

        /* Botão Principal (Decolar) */
        .btn-main {
            margin-top: 5vh;
            background: rgba(0,0,0,0.5); color: var(--green);
            border: 2px solid var(--green); 
            padding: 1.2rem 3.5rem;
            font-size: clamp(1rem, 1.5vw, 1.4rem); 
            font-family: 'Orbitron', sans-serif; font-weight: 900;
            text-transform: uppercase; letter-spacing: 4px; 
            cursor: pointer; pointer-events: auto;
            clip-path: polygon(10% 0, 100% 0, 100% 70%, 90% 100%, 0 100%, 0 30%);
            transition: all 0.3s ease;
        }
        .btn-main:hover {
            background: var(--green); color: #000;
            box-shadow: 0 0 40px rgba(0, 255, 157, 0.6); transform: scale(1.05);
        }

        /* --- COMPONENTE 4: PAINEL DIREITO (INFO) --- */
        .hud-right-panel {
            grid-column: 3 / 4; grid-row: 2 / 3;
            display: flex; align-items: center; justify-content: flex-end;
            pointer-events: auto;
        }

        .holo-card {
            background: linear-gradient(135deg, rgba(255,255,255,0.03) 0%, rgba(0,0,0,0.85) 100%);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-right: 3px solid var(--purple);
            padding: 25px;
            width: 100%;
            transform: perspective(1000px) rotateY(-10deg);
            box-shadow: -10px 10px 30px rgba(0,0,0,0.5);
        }
        .holo-card h3 {
            color: #fff; font-size: 1rem; margin: 0 0 10px 0; letter-spacing: 2px;
            border-bottom: 1px solid rgba(255,255,255,0.2); padding-bottom: 8px;
        }
        .holo-card p {
            font-family: 'Jura', sans-serif; color: #ddd; font-size: 0.85rem; line-height: 1.6; margin: 0;
        }

        /* --- MEDIA QUERIES (TABLET & MOBILE) --- */
        @media (max-width: 1024px) {
            #ui-layer {
                /* Muda para layout vertical */
                grid-template-columns: 1fr;
                grid-template-rows: auto auto 1fr auto; 
                gap: 10px;
                padding: 10px;
                padding-top: max(10px, var(--safe-top));
                padding-bottom: max(10px, var(--safe-bottom));
            }

            /* 1. Header (Topo) */
            .hud-header {
                grid-column: 1 / -1; grid-row: 1 / 2;
                flex-direction: row; justify-content: space-between; align-items: center;
                border-left: none; border-bottom: 2px solid var(--green);
                padding: 10px; background: rgba(0,0,0,0.3);
            }

            /* 2. Conteúdo Central (Sobe para dar espaço) */
            #main-center {
                grid-column: 1 / -1; grid-row: 3 / 4;
                justify-content: flex-start; padding-top: 20px;
            }
            .stats-row { margin-bottom: 15px; transform: scale(0.9); }
            .title-3d { margin-bottom: 10px; }
            .btn-main { padding: 1rem 3rem; margin-top: 20px; }

            /* 3. Painel de Info (Fica abaixo do título ou escondido em telas mto pequenas se quiser) */
            .hud-right-panel {
                grid-column: 1 / -1; grid-row: 2 / 3; /* Move para cima do título em mobile para não cobrir o 3D embaixo */
                justify-content: center;
                margin-bottom: 10px;
            }
            .holo-card {
                transform: none; text-align: center;
                border-right: 1px solid rgba(255,255,255,0.1);
                border-bottom: 3px solid var(--purple);
                background: rgba(0,0,0,0.6);
                padding: 15px; max-width: 90%;
            }

            /* 4. Sidebar vira Dock Inferior (UX Mobile) */
            .hud-sidebar {
                grid-column: 1 / -1; grid-row: 4 / 5;
                flex-direction: row; 
                justify-content: flex-start; /* Scroll horizontal */
                overflow-x: auto;
                background: rgba(0,0,0,0.8);
                backdrop-filter: blur(15px);
                padding: 15px;
                border-top: 1px solid var(--purple);
                gap: 15px;
                
                /* Fixação no fundo para sensação de App */
                position: fixed; bottom: 0; left: 0; width: 100%;
                z-index: 50;
                padding-bottom: max(15px, var(--safe-bottom));
            }
            
            .tech-btn {
                min-width: 140px; flex-shrink: 0;
                font-size: 0.75rem;
                padding: 10px;
            }
        }

        /* AJUSTES FINOS PARA CELULARES PEQUENOS */
        @media (max-width: 480px) {
            .title-3d { font-size: 3.0rem; }
            .holo-card { display: none; } /* Ocultar card de info em telas muito pequenas para limpar visão */
            .stats-row { gap: 5px; }
            .stat-module { padding: 5px 8px; }
            .stars { letter-spacing: 1px; }
        }

        /* --- TEXTOS CINEMÁTICOS (ENTRADA) --- */
        .cinematic-text {
            position: absolute; top: 50%; left: 50%;
            transform: translate(-50%, -50%) scale(0.8);
            text-align: center; opacity: 0; width: 100%; pointer-events: none;
            transition: opacity 0.5s ease, transform 4s ease-out;
            z-index: 30;
        }
        .cinematic-text h1 {
            font-size: clamp(2rem, 8vw, 6rem); 
            font-weight: 900; color: #fff; letter-spacing: clamp(5px, 2vw, 15px);
            text-shadow: 0 0 30px var(--purple); text-transform: uppercase; margin: 0;
        }
        .cinematic-text p {
            font-family: 'Jura', sans-serif; font-size: clamp(0.8rem, 3vw, 1.5rem); 
            letter-spacing: 8px; color: var(--green); margin-top: 15px; text-transform: uppercase;
        }
        .cinematic-text.visible { opacity: 1; transform: translate(-50%, -50%) scale(1.1); }

        /* --- TELA FINAL --- */
        #end-screen {
            position: absolute; bottom: 30%; width: 100%; text-align: center;
            opacity: 0; pointer-events: none; transition: opacity 1s; z-index: 40;
        }
        #end-screen.active { opacity: 1; pointer-events: auto; }
        
        .btn-final {
            background: transparent; color: var(--purple); border: 2px solid var(--purple);
            padding: 20px 60px; font-size: clamp(1.2rem, 4vw, 2rem); 
            font-family: 'Orbitron', sans-serif; font-weight: 900; 
            letter-spacing: 5px; cursor: pointer; text-transform: uppercase;
            box-shadow: 0 0 30px rgba(188, 19, 254, 0.2); transition: 0.3s;
            background: rgba(0,0,0,0.8);
        }
        .btn-final:hover {
            background: var(--purple); color: white;
            box-shadow: 0 0 80px var(--purple); transform: scale(1.1);
        }

        /* Flash Effects */
        #white-flash { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: white; opacity: 0; pointer-events: none; z-index: 999; transition: opacity 0.1s; }
        #fade-white { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: white; opacity: 0; pointer-events: none; z-index: 998; transition: opacity 2s ease-in; }

        @keyframes breathe { 0%, 100% { transform: scale(1); filter: brightness(1); } 50% { transform: scale(1.02); filter: brightness(1.2); } }
    </style>
</head>
<body>

    <div class="vignette"></div>
    <div class="grain"></div>

    <div id="canvas-container"></div>
    
    <div id="white-flash"></div>
    <div id="fade-white"></div>

    <div id="ui-layer">
        
        <div class="hud-header">
            <div>
                <div class="hud-text-small">SYS.VER. 12.0</div>
                <div class="hud-text-small" style="color:#fff; text-shadow:0 0 10px white;">ONLINE</div>
            </div>
            <div class="hud-text-small" style="display: none; align-self: center;" id="mobile-indicator">SECURE</div>
        </div>

        <div class="hud-sidebar">
            <div class="tech-btn" onclick="alert('Scan completo: Topografia estável.')">
                SCANEAR
                <span class="btn-desc">Análise de Terreno</span>
            </div>
            <div class="tech-btn" onclick="alert('Neural Link: Conectado.')">
                NEURAL LINK
                <span class="btn-desc">Sincronização IA</span>
            </div>
            <div class="tech-btn" onclick="alert('Navegação: Rota definida.')">
                NAVEGAÇÃO
                <span class="btn-desc">GPS Interestelar</span>
            </div>
        </div>

        <div id="main-center">
            
            <div class="stats-row">
                <div class="stat-module">
                    <div class="stars">★★★★★</div>
                    <span class="stat-label">PROPULSÃO</span>
                </div>
                <div class="stat-module">
                    <div class="stars">★★★★★</div>
                    <span class="stat-label">INTELIGÊNCIA</span>
                </div>
                <div class="stat-module">
                    <div class="stars">★★★★★</div>
                    <span class="stat-label">DEFESA</span>
                </div>
            </div>

            <h1 class="title-3d">APROVADOS<br>AI</h1>
            <div class="subtitle-3d">A Próxima Fronteira Digital</div>
            
            <button id="btn-warp" class="btn-main">DECOLAR</button>

        </div>

        <div class="hud-right-panel">
            <div class="holo-card">
                <h3>DADOS DA MISSÃO</h3>
                <p>
                    Renderização de alta performance ativa. 
                    <br>Sistemas otimizados para todos os dispositivos.
                    <br>Aguardando comando do piloto.
                </p>
            </div>
        </div>

    </div>

    <div id="msg1" class="cinematic-text">
        <h1>INOVAÇÃO</h1>
        <p>Tecnologia do Futuro</p>
    </div>
    <div id="msg2" class="cinematic-text">
        <h1>AGENTES</h1>
        <p>Inteligência Autônoma</p>
    </div>
    <div id="msg3" class="cinematic-text">
        <h1>VELOCIDADE</h1>
        <p>Performance Máxima</p>
    </div>
    <div id="msg4" class="cinematic-text">
        <h1>VENDAS</h1>
        <p>INEVITÁVEIS</p>
    </div>

    <div id="end-screen">
        <button id="btn-enter" class="btn-final">INICIAR</button>
    </div>

    <script type="importmap">
        {
            "imports": {
                "three": "https://unpkg.com/three@0.160.0/build/three.module.js",
                "three/addons/": "https://unpkg.com/three@0.160.0/examples/jsm/"
            }
        }
    </script>

    <script type="module">
        import * as THREE from 'three';
        import { EffectComposer } from 'three/addons/postprocessing/EffectComposer.js';
        import { RenderPass } from 'three/addons/postprocessing/RenderPass.js';
        import { UnrealBloomPass } from 'three/addons/postprocessing/UnrealBloomPass.js';

        class SpaceExperience {
            constructor() {
                this.state = { phase: 'idle', speed: 0, distance: 0 };
                this.config = { 
                    warpSpeed: 10.0, 
                    warpDistance: 4500, 
                    colors: { purple: 0xbc13fe, green: 0x00ff9d, blue: 0x00d0ff, dark: 0x0a0a0a }
                };

                this.mouse = new THREE.Vector2();
                this.targetRotation = new THREE.Vector2();

                this.initDOM();
                this.initThree();
                this.createStarfield(); 
                this.createPlanet();    
                this.createModernShip(); 
                this.initPostProcessing();
                this.addEvents();
                
                // Chamada inicial para ajustar a câmera ao layout
                this.onWindowResize();
                
                this.animate();
            }

            initDOM() {
                this.dom = {
                    uiLayer: document.getElementById('ui-layer'),
                    btnWarp: document.getElementById('btn-warp'),
                    endScreen: document.getElementById('end-screen'),
                    btnEnter: document.getElementById('btn-enter'),
                    whiteFlash: document.getElementById('white-flash'),
                    fadeWhite: document.getElementById('fade-white'),
                    msgs: [
                        document.getElementById('msg1'), document.getElementById('msg2'),
                        document.getElementById('msg3'), document.getElementById('msg4')
                    ],
                    // A sidebar agora é selecionada genericamente para sumir na animação
                    sidebar: document.querySelector('.hud-sidebar')
                };

                this.dom.btnWarp.addEventListener('click', (e) => { e.stopPropagation(); this.startWarp(); });
                this.dom.btnEnter.addEventListener('click', (e) => { e.stopPropagation(); this.launch(); });
            }

            initThree() {
                this.container = document.getElementById('canvas-container');
                this.scene = new THREE.Scene();
                this.scene.fog = new THREE.FogExp2(0x050505, 0.00015);

                this.camera = new THREE.PerspectiveCamera(70, window.innerWidth / window.innerHeight, 0.1, 50000);
                
                this.renderer = new THREE.WebGLRenderer({ antialias: false, powerPreference: "high-performance" });
                this.renderer.setSize(window.innerWidth, window.innerHeight);
                this.renderer.setPixelRatio(Math.min(window.devicePixelRatio, 1.5)); // Otimização para retina displays
                this.container.appendChild(this.renderer.domElement);

                // Luzes
                const ambient = new THREE.AmbientLight(0xffffff, 0.1);
                this.scene.add(ambient);
                
                const sun = new THREE.DirectionalLight(0xffffff, 1.5);
                sun.position.set(500, 200, 100);
                this.scene.add(sun);

                const topLight = new THREE.DirectionalLight(this.config.colors.purple, 2);
                topLight.position.set(0, 10, 5);
                this.scene.add(topLight);
            }

            createPlanet() {
                this.jupiterGroup = new THREE.Group();
                this.jupiterGroup.position.set(0, 0, -8000); 
                this.jupiterGroup.rotation.z = Math.PI / 8;

                const planetGeo = new THREE.SphereGeometry(2500, 64, 64);
                const planetMat = new THREE.MeshStandardMaterial({ 
                    color: 0x120a1f, roughness: 0.8, metalness: 0.1
                });
                const planetBase = new THREE.Mesh(planetGeo, planetMat);

                const bandMat = new THREE.MeshBasicMaterial({ color: 0x5e00ff, transparent: true, opacity: 0.1 });
                const band1 = new THREE.Mesh(new THREE.TorusGeometry(2520, 100, 2, 100), bandMat);
                band1.rotation.x = Math.PI / 2;
                planetBase.add(band1);

                const bandMat2 = new THREE.MeshBasicMaterial({ color: this.config.colors.blue, transparent: true, opacity: 0.08 });
                const band2 = new THREE.Mesh(new THREE.TorusGeometry(2550, 60, 2, 100), bandMat2);
                band2.rotation.x = Math.PI / 2;
                band2.position.y = 500;
                planetBase.add(band2);

                this.jupiterGroup.add(planetBase);

                // Anéis
                const ringGeo = new THREE.RingGeometry(3200, 5000, 128);
                const ringMat = new THREE.MeshBasicMaterial({ color: 0xbc13fe, side: THREE.DoubleSide, transparent: true, opacity: 0.15 });
                const rings = new THREE.Mesh(ringGeo, ringMat);
                rings.rotation.x = Math.PI / 2;
                this.jupiterGroup.add(rings);
                
                const ringInnerGeo = new THREE.RingGeometry(2900, 3000, 128);
                const ringInnerMat = new THREE.MeshBasicMaterial({ color: 0xffffff, side: THREE.DoubleSide, transparent: true, opacity: 0.4 });
                const ringInner = new THREE.Mesh(ringInnerGeo, ringInnerMat);
                ringInner.rotation.x = Math.PI / 2;
                this.jupiterGroup.add(ringInner);

                this.scene.add(this.jupiterGroup);
                this.planet = this.jupiterGroup;
            }

            createModernShip() {
                this.ship = new THREE.Group();
                this.ship.scale.set(1.3, 1.3, 1.3);

                const hullMat = new THREE.MeshStandardMaterial({ color: 0x080808, roughness: 0.2, metalness: 0.9 });
                const engineMat = new THREE.MeshBasicMaterial({ color: this.config.colors.green });

                // Corpo
                const bodyGeo = new THREE.ConeGeometry(1, 6, 8);
                bodyGeo.rotateX(Math.PI / 2);
                const body = new THREE.Mesh(bodyGeo, hullMat);
                
                const edges = new THREE.EdgesGeometry(bodyGeo);
                const lines = new THREE.LineSegments(edges, new THREE.LineBasicMaterial({ color: 0x555555 }));
                body.add(lines);
                this.ship.add(body);

                // Asas
                const wingShape = new THREE.Shape();
                wingShape.moveTo(0, 0);
                wingShape.lineTo(2, -1.5);
                wingShape.lineTo(2, -3);
                wingShape.lineTo(0.5, -2);
                wingShape.lineTo(0, 0);
                const wingGeo = new THREE.ExtrudeGeometry(wingShape, { depth: 0.1, bevelEnabled: false });
                wingGeo.rotateX(Math.PI / 2);
                
                const wingL = new THREE.Mesh(wingGeo, hullMat);
                wingL.position.set(-0.5, 0, 1);
                wingL.rotation.z = 0.2;
                wingL.add(new THREE.LineSegments(new THREE.EdgesGeometry(wingGeo), new THREE.LineBasicMaterial({ color: this.config.colors.purple })));
                
                const wingR = new THREE.Mesh(wingGeo, hullMat);
                wingR.position.set(0.5, 0, 1);
                wingR.rotation.z = -0.2;
                wingR.scale.x = -1;
                wingR.add(new THREE.LineSegments(new THREE.EdgesGeometry(wingGeo), new THREE.LineBasicMaterial({ color: this.config.colors.purple })));

                this.ship.add(wingL);
                this.ship.add(wingR);

                // Motores
                const engineGeo = new THREE.CylinderGeometry(0.4, 0.6, 1.5, 12);
                engineGeo.rotateX(Math.PI / 2);
                const engineL = new THREE.Mesh(engineGeo, hullMat);
                engineL.position.set(-1.2, -0.2, 2.5);
                engineL.add(new THREE.Mesh(new THREE.CircleGeometry(0.5, 12), engineMat).translateZ(0.76));
                
                const engineR = new THREE.Mesh(engineGeo, hullMat);
                engineR.position.set(1.2, -0.2, 2.5);
                engineR.add(new THREE.Mesh(new THREE.CircleGeometry(0.5, 12), engineMat).translateZ(0.76));

                this.ship.add(engineL);
                this.ship.add(engineR);

                // Luz do motor
                this.engineLight = new THREE.PointLight(this.config.colors.green, 0, 20);
                this.engineLight.position.set(0, 0, 5);
                this.ship.add(this.engineLight);

                this.scene.add(this.ship);
            }

            createStarfield() {
                const count = 3500;
                const geometry = new THREE.BoxGeometry(0.2, 0.2, 1);
                const material = new THREE.MeshBasicMaterial({ color: 0xffffff });
                this.stars = new THREE.InstancedMesh(geometry, material, count);
                
                this.starData = [];
                const dummy = new THREE.Object3D();

                for(let i=0; i<count; i++) {
                    const x = (Math.random() - 0.5) * 6000;
                    const y = (Math.random() - 0.5) * 6000;
                    const z = (Math.random() - 0.5) * 3000;
                    
                    dummy.position.set(x, y, z);
                    dummy.updateMatrix();
                    this.stars.setMatrixAt(i, dummy.matrix);
                    
                    this.starData.push({x,y,z});
                }
                this.scene.add(this.stars);
            }

            initPostProcessing() {
                this.composer = new EffectComposer(this.renderer);
                this.composer.addPass(new RenderPass(this.scene, this.camera));
                // Bloom ajustado para não "estourar" o branco dos textos
                const bloom = new UnrealBloomPass(new THREE.Vector2(window.innerWidth, window.innerHeight), 2.0, 0.5, 0.1);
                this.composer.addPass(bloom);
            }

            addEvents() {
                const handleInput = (x, y) => {
                    this.mouse.x = (x / window.innerWidth) * 2 - 1;
                    this.mouse.y = -(y / window.innerHeight) * 2 + 1;
                };

                window.addEventListener('mousemove', (e) => handleInput(e.clientX, e.clientY));
                window.addEventListener('touchmove', (e) => {
                    if(e.touches.length > 0) handleInput(e.touches[0].clientX, e.touches[0].clientY);
                }, { passive: false });

                window.addEventListener('resize', () => this.onWindowResize());
            }

            onWindowResize() {
                const width = window.innerWidth;
                const height = window.innerHeight;
                
                this.camera.aspect = width / height;
                this.camera.updateProjectionMatrix();
                this.renderer.setSize(width, height);
                this.composer.setSize(width, height);

                // LÓGICA DE POSICIONAMENTO INTELIGENTE DA NAVE
                if (width < 768) {
                    // Mobile (Portrait): Afastar a câmera para ver tudo
                    this.camera.position.z = 20;
                    this.ship.position.y = -1.5; // Baixa a nave para não competir com o texto central
                } else if (width < 1200) {
                    // Tablet
                    this.camera.position.z = 15;
                    this.ship.position.y = -0.5;
                } else {
                    // Desktop Widescreen
                    this.camera.position.z = 10;
                    this.ship.position.y = 0;
                }
            }

            startWarp() {
                this.state.phase = 'warp';
                
                // Animação de saída da UI
                this.dom.uiLayer.style.opacity = '0';
                this.dom.uiLayer.style.transform = 'scale(1.1) perspective(100px) rotateX(5deg)';
                this.dom.uiLayer.style.transition = 'all 1s ease-in';
                this.dom.uiLayer.style.pointerEvents = 'none';
                
                this.engineLight.intensity = 5; 
            }

            launch() {
                this.state.phase = 'launch';
                this.dom.endScreen.style.opacity = '0';
                this.dom.endScreen.style.pointerEvents = 'none';
                this.dom.whiteFlash.style.opacity = '0.8';
                
                setTimeout(() => { this.dom.whiteFlash.style.opacity = '0'; }, 100);
                setTimeout(() => { this.dom.fadeWhite.style.opacity = '1'; }, 1000);
                // Redirecionamento
                setTimeout(() => { window.location.href = "https://tadeusiaa-create.github.io/pagina-de-produtos/"; }, 2500);
            }

            updateTexts(percent) {
                const msgs = this.dom.msgs;
                const duration = 0.22; 
                const check = (start, el) => {
                    if (percent > start && percent < (start + duration)) el.classList.add('visible');
                    else el.classList.remove('visible');
                }
                check(0.15, msgs[0]);
                check(0.35, msgs[1]);
                check(0.55, msgs[2]);
                check(0.75, msgs[3]);
            }

            animate() {
                requestAnimationFrame(this.animate.bind(this));

                if(this.planet) this.planet.rotation.y += 0.0001;

                if (this.state.phase !== 'launch') {
                    // Movimento suave da nave seguindo o mouse
                    this.targetRotation.x = this.mouse.y * 0.4;
                    this.targetRotation.y = -this.mouse.x * 0.4;
                    
                    this.ship.rotation.x += (this.targetRotation.x - this.ship.rotation.x) * 0.05;
                    this.ship.rotation.y += (this.targetRotation.y - this.ship.rotation.y) * 0.05;
                    this.ship.rotation.z = -this.ship.rotation.y * 0.8; 

                    this.ship.position.x += (this.mouse.x * 4 - this.ship.position.x) * 0.05;
                    this.ship.position.y += (this.mouse.y * 2 - this.ship.position.y) * 0.05;
                    
                    // Câmera segue levemente a nave (Parallax)
                    this.camera.position.x += (this.ship.position.x * 0.3 - this.camera.position.x) * 0.05;
                    this.camera.position.y += (this.ship.position.y * 0.3 + 3 - this.camera.position.y) * 0.05;
                } else {
                    // Sequência de lançamento (Warp)
                    this.ship.position.z -= 4; 
                    this.ship.scale.z = 4; // Esticar nave
                    this.camera.position.x += (Math.random()-0.5) * 0.5; // Shake
                    this.camera.position.y += (Math.random()-0.5) * 0.5;
                }

                if (this.state.phase === 'warp') {
                    if (this.state.speed < this.config.warpSpeed) this.state.speed += 0.05;
                    
                    this.state.distance += this.state.speed;
                    const pct = this.state.distance / this.config.warpDistance;
                    this.updateTexts(pct);
                    if (pct >= 1) this.state.phase = 'arrived';
                } else if (this.state.phase === 'arrived') {
                    this.state.speed *= 0.95; 
                    if (this.state.speed < 0.2) {
                        this.state.speed = 0.2; 
                        this.dom.endScreen.classList.add('active');
                    }
                }

                const currentSpeed = (this.state.phase === 'launch') ? 50 : this.state.speed;
                const dummy = new THREE.Object3D();
                
                for(let i=0; i<3500; i++) {
                    let d = this.starData[i];
                    d.z += currentSpeed * 10 + 0.2;
                    if (d.z > 20) {
                        d.z = -3000;
                        d.x = (Math.random() - 0.5) * 6000;
                        d.y = (Math.random() - 0.5) * 6000;
                    }
                    dummy.position.set(d.x, d.y, d.z);
                    const stretch = 1 + (currentSpeed * 2);
                    dummy.scale.set(1, 1, stretch);
                    dummy.updateMatrix();
                    this.stars.setMatrixAt(i, dummy.matrix);
                }
                this.stars.instanceMatrix.needsUpdate = true;
                this.composer.render();
            }
        }

        new SpaceExperience();
    </script>
</body>
</html>
